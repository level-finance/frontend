<script setup lang="ts">
import { computed } from 'vue';
import useTokens from '@/composables/useTokens';
import useNumbers, { FNumFormats } from '@/composables/useNumbers';

/**
 * TYPES
 */
type Props = {
  address: string;
  selected: boolean;
};

/**
 * PROPS
 */
const props = defineProps<Props>();

/**
 * COMPOSABLES
 */
const { getToken, balanceFor } = useTokens();
const { fNum2, toFiat } = useNumbers();

/**
 * COMPUTED
 */
const token = computed(() => getToken(props.address));

const balanceLabel = computed(() =>
  fNum2(balanceFor(props.address), FNumFormats.token)
);

const fiatLabel = computed(() => {
  const tokenBalance = balanceFor(props.address);
  const fiatValue = toFiat(tokenBalance, props.address);

  if (Number(fiatValue) === 0 && Number(tokenBalance) > 0) {
    return '-';
  } else {
    return fNum2(fiatValue, FNumFormats.fiat);
  }
});
</script>

<template>
  <div :class="['flex justify-between', { 'text-gray-400': !selected }]">
    <div class="flex flex-col">
      <span class="text-xl font-bold">
        {{ token.symbol }}
      </span>
      <span
        v-if="token.name !== token.symbol"
        :class="['text-base', selected ? 'text-black' : 'text-gray-400']"
      >
        {{ token.name }}
      </span>
    </div>

    <div class="flex flex-col text-right">
      <span class="text-xl font-bold">
        {{ balanceLabel }}
      </span>
      <span :class="['text-base', selected ? 'text-black' : 'text-gray-400']">
        {{ fiatLabel }}
      </span>
    </div>
  </div>
</template>
